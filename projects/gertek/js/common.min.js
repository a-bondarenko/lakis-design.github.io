$(function(){var e=new function(){this.dye=function(){var e=$(".b-header"),t=$("body").offset().top;$(window).scrollTop()>t?$(e).addClass("small"):$(e).removeClass("small")}},t=new function(){var e=this;this.toggleMenu=function(){$(".open-nav").toggleClass("open"),$(".b-main-menu").toggleClass("open"),$(".b-toggle-menu__open-ico, .b-toggle-menu__close-ico").toggleClass("hidden")},this.closeMenuAnywhere=function(t){function n(){return $(".b-main-menu").hasClass("open")}!$(t).closest(".b-main-menu").length&&!$(t).closest(".b-toggle-menu").length&&n()&&e.toggleMenu()}},n=new function(){var e=this;this.openPopup=function(){$("body").addClass("no-scroll"),$(".b-header").addClass("header-noscroll"),$(".b-popup-wrapper").removeClass("hidden"),$(".b-popup-wrapper").addClass("show-popup")},this.closePopup=function(){$("body").removeClass("no-scroll"),$(".b-header").removeClass("header-noscroll"),$(".b-popup-wrapper").removeClass("show-popup"),$(".b-popup-wrapper").addClass("hidden")},this.closePopupAnywhere=function(t){function n(){return $(".b-popup-wrapper").hasClass("show-popup")}!$(t).closest(".b-popup").length&&!$(t).closest(".open-popup").length&&n()&&e.closePopup()}},i=new function(){var e=this;this.sendMassage=function(t){return $.ajax({type:"POST",url:"/mail.php",data:$(t).serialize()}).done(function(){e.showConfirm(t)}),!1},this.showConfirm=function(e){function t(){$(e).trigger("reset"),$(e).find(".b-form__fieldset").addClass("hide-form"),$(r).addClass("show-form-confirm")}function i(){$(e).closest(".b-popup").length&&n.closePopup(),$(r).removeClass("show-form-confirm"),$(e).find(".b-form__fieldset").removeClass("hide-form")}var r=$(e).find(".b-form__confirm");t(),setTimeout(function(){i()},1500)},this.validateForm=function(t){$(t).validate({rules:{phone:{number:!0}},errorPlacement:function(e,t){return!0},errorClass:"b-form__input--error",submitHandler:function(t){e.sendMassage(t)}})},this.validateInit=function(){$(".b-form").each(function(){var t=$(this);e.validateForm(t)})},this.togglePlaceholder=function(e){var t=$(e).attr("placeholder");$(e).attr("placeholder",""),$(e).focusout(function(){$(e).attr("placeholder",t)})}},r=new function(){this.init=function(){function e(e){l=e,t(),n()}function t(){s=$("<div>",{id:"progressBar"}),a=$("<div>",{id:"bar"}),s.append(a).prependTo(l)}function n(){d=0,u=!1,c=setInterval(i,10)}function i(){!1===u&&(d+=1/f,a.css({width:d+"%"}),d>=100&&l.trigger("owl.next"))}function r(){u=!0}function o(){clearTimeout(c),n()}$(".b-slider").owlCarousel({autoPlay:5e3,slideSpeed:800,navigation:!0,pagination:!1,singleItem:!0,navigationText:['<span class="b-slider__navigation b-slider__navigation--prev"><i class="fa fa-angle-left" aria-hidden="true"></i></span>','<span class="b-slider__navigation b-slider__navigation--next"><i class="fa fa-angle-right" aria-hidden="true"></i></span>'],afterInit:e,afterMove:o,startDragging:r});var s,a,l,u,c,d,f=5},this.paralax=function(){var e=$(window).scrollTop();$(".b-slider").css({transform:"translateY("+e/2+"px)"})}},o=new function(){this.init=function(){$(".b-gallery__item").magnificPopup({type:"image",gallery:{enabled:!0}})}},s=new function(){this.show=function(e){$(e).find(".b-about-block__content-container").addClass("show")},this.hide=function(e){$(e).find(".b-about-block__content-container").removeClass("show")},this.animateBackground=function(){$(".b-about-block").each(function(){var e=$(this).offset(),t=$(this).prev();if(!e)return!1;var n=e.top,i=$(this).height()/2;$(window).scroll(function(){if(scrollTop=$(window).scrollTop(),scrollTop>n-i&&scrollTop<n){var e=1-(n-scrollTop)/i;$(t).find(".b-about-block__dark-layer").css("opacity",e)}})})},this.fix=function(){$(".b-about-block__content-container").addClass("fixed")},this.unfix=function(){$(".b-about-block__content-container").removeClass("fixed")}},a=new function(){this.fix=function(){$(".b-about-navigation").addClass("fixed")},this.unfix=function(){$(".b-about-navigation").removeClass("fixed")},this.fixToBottom=function(){$(".b-about-navigation").addClass("fix-to-bottom")},this.unfixFromBottom=function(){$(".b-about-navigation").removeClass("fix-to-bottom")},this.slideLink=function(e){switch(e){case 0:$(".b-about-navigation__link").css("transform","translateY(0)");break;case 1:$(".b-about-navigation__link").css("transform","translateY(123px)");break;case 2:$(".b-about-navigation__link").css("transform","translateY(246px)");break;case 3:$(".b-about-navigation__link").css("transform","translateY(370px)")}}},l=new function(){this.BgAnimation=function(){var e=$(".b-trolley").offset();if(!e)return!1;var t=e.top,n=$(".b-trolley").height()/2,i=$(window).scrollTop();if(i>t-n&&i<t){var r=1-(t-i)/n,o=1.5-r;o<1&&(o=1),$(".b-trolley__background").css("transform","scale("+o+")")}}};e.dye(),o.init(),i.validateInit(),r.init(),s.animateBackground(),$(window).scroll(function(){e.dye(),r.paralax(),l.BgAnimation()}),$(document).click(function(e){var i=$(e.target);t.closeMenuAnywhere(i),n.closePopupAnywhere(i)}),$(".open-nav").click(function(){t.toggleMenu()}),$(".open-popup").click(function(){n.openPopup()}),$(".close-popup").click(function(){n.closePopup()}),$("input, textarea").focus(function(){i.togglePlaceholder($(this))}),$(".b-about-block").waypoint(function(e){var t=this.element;0==$(t).index()?"down"==e?(s.fix(),a.fix()):"up"==e&&(s.unfix(),a.unfix()):3==$(t).index()&&("down"==e?(s.unfix(),a.fixToBottom()):"up"==e&&(s.fix(),a.unfixFromBottom()))},{offset:"70px"}),$(".b-about-block").waypoint(function(e){var t=this.element,n=$(t).prev(),i=$(t).index();if("down"==e)s.show(t,e),s.hide(n,e),a.slideLink(i);else if("up"==e){if(0==$(t).index())return!1;s.hide(t),s.show(n),a.slideLink(i-1)}},{offset:"50%"})});